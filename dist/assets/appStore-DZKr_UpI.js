var V=Object.defineProperty;var T=(t,s,e)=>s in t?V(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var h=(t,s,e)=>T(t,typeof s!="symbol"?s+"":s,e);import{c as A}from"./state-BjmFXnif.js";function R(t,s){let e;try{e=t()}catch{return}return{getItem:n=>{var r;const c=p=>p===null?null:JSON.parse(p,void 0),o=(r=e.getItem(n))!=null?r:null;return o instanceof Promise?o.then(c):c(o)},setItem:(n,r)=>e.setItem(n,JSON.stringify(r,void 0)),removeItem:n=>e.removeItem(n)}}const E=t=>s=>{try{const e=t(s);return e instanceof Promise?e:{then(i){return E(i)(e)},catch(i){return this}}}catch(e){return{then(i){return this},catch(i){return E(i)(e)}}}},H=(t,s)=>(e,i,n)=>{let r={storage:R(()=>window.localStorage),partialize:a=>a,version:0,merge:(a,f)=>({...f,...a}),...s},c=!1,o=0;const p=new Set,y=new Set;let m=r.storage;if(!m)return t((...a)=>{e(...a)},i,n);const b=()=>{const a=r.partialize({...i()});return m.setItem(r.name,{state:a,version:r.version})},_=n.setState;n.setState=(a,f)=>(_(a,f),b());const S=t((...a)=>(e(...a),b()),i,n);n.getInitialState=()=>S;let v;const x=()=>{var a,f;if(!m)return;const w=++o;c=!1,p.forEach(l=>{var d;return l((d=i())!=null?d:S)});const g=((f=r.onRehydrateStorage)==null?void 0:f.call(r,(a=i())!=null?a:S))||void 0;return E(m.getItem.bind(m))(r.name).then(l=>{if(l)if(typeof l.version=="number"&&l.version!==r.version){if(r.migrate){const d=r.migrate(l.state,l.version);return d instanceof Promise?d.then(M=>[!0,M]):[!0,d]}}else return[!1,l.state];return[!1,void 0]}).then(l=>{var d;if(w!==o)return;const[M,C]=l;if(v=r.merge(C,(d=i())!=null?d:S),e(v,!0),M)return b()}).then(()=>{w===o&&(g?.(v,void 0),v=i(),c=!0,y.forEach(l=>l(v)))}).catch(l=>{w===o&&g?.(void 0,l)})};return n.persist={setOptions:a=>{r={...r,...a},a.storage&&(m=a.storage)},clearStorage:()=>{m?.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>x(),hasHydrated:()=>c,onHydrate:a=>(p.add(a),()=>{p.delete(a)}),onFinishHydration:a=>(y.add(a),()=>{y.delete(a)})},r.skipHydration||x(),v||S},D=H,k=[{name:"click",url:"https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3",volume:.3},{name:"success",url:"https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3",volume:.4},{name:"error",url:"https://assets.mixkit.co/active_storage/sfx/2572/2572-preview.mp3",volume:.3},{name:"hover",url:"https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3",volume:.1},{name:"notification",url:"https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3",volume:.4},{name:"checkout",url:"https://assets.mixkit.co/active_storage/sfx/2003/2003-preview.mp3",volume:.5},{name:"addToCart",url:"https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3",volume:.3},{name:"remove",url:"https://assets.mixkit.co/active_storage/sfx/2572/2572-preview.mp3",volume:.2},{name:"switch",url:"https://assets.mixkit.co/active_storage/sfx/2570/2570-preview.mp3",volume:.2}],I=[{name:"ambient1",url:"https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lofi-study-112778.mp3",volume:.15},{name:"ambient2",url:"https://cdn.pixabay.com/download/audio/2022/03/15/audio_c8c8a73467.mp3?filename=relaxing-mountains-rivers-streams-birds-18177.mp3",volume:.15}];class F{constructor(){h(this,"soundEnabled",!0);h(this,"musicEnabled",!1);h(this,"audioCache",new Map);h(this,"currentMusic",null);h(this,"musicIndex",0);h(this,"masterVolume",1);h(this,"musicVolume",.15);this.loadSettings(),this.preloadSounds()}loadSettings(){if(typeof window<"u"){const s=localStorage.getItem("sound_enabled"),e=localStorage.getItem("music_enabled"),i=localStorage.getItem("master_volume");this.soundEnabled=s!==null?s==="true":!0,this.musicEnabled=e!==null?e==="true":!1,this.masterVolume=i!==null?parseFloat(i):1}}saveSettings(){typeof window<"u"&&(localStorage.setItem("sound_enabled",this.soundEnabled.toString()),localStorage.setItem("music_enabled",this.musicEnabled.toString()),localStorage.setItem("master_volume",this.masterVolume.toString()))}preloadSounds(){k.forEach(s=>{const e=new Audio(s.url);e.volume=s.volume*this.masterVolume,e.preload="auto",this.audioCache.set(s.name,e)})}playSound(s){if(!this.soundEnabled)return;const e=this.audioCache.get(s);e&&(e.currentTime=0,e.volume=(k.find(i=>i.name===s)?.volume||.3)*this.masterVolume,e.play().catch(i=>{}))}playClick(){this.playSound("click")}playSuccess(){this.playSound("success")}playError(){this.playSound("error")}playHover(){this.playSound("hover")}playNotification(){this.playSound("notification")}playCheckout(){this.playSound("checkout")}playAddToCart(){this.playSound("addToCart")}playRemove(){this.playSound("remove")}playSwitch(){this.playSound("switch")}toggleMusic(){return this.musicEnabled=!this.musicEnabled,this.saveSettings(),this.musicEnabled?this.startMusic():this.stopMusic(),this.musicEnabled}isMusicEnabled(){return this.musicEnabled}startMusic(){if(!this.musicEnabled)return;this.stopMusic();const s=I[this.musicIndex];this.currentMusic=new Audio(s.url),this.currentMusic.volume=this.musicVolume*this.masterVolume,this.currentMusic.loop=!1,this.currentMusic.addEventListener("ended",()=>{this.musicIndex=(this.musicIndex+1)%I.length,this.startMusic()}),this.currentMusic.play().catch(e=>{this.musicIndex=(this.musicIndex+1)%I.length})}stopMusic(){this.currentMusic&&(this.currentMusic.pause(),this.currentMusic.currentTime=0,this.currentMusic=null)}toggleSound(){return this.soundEnabled=!this.soundEnabled,this.saveSettings(),this.soundEnabled}isSoundEnabled(){return this.soundEnabled}setMasterVolume(s){this.masterVolume=Math.max(0,Math.min(1,s)),this.saveSettings(),this.currentMusic&&(this.currentMusic.volume=this.musicVolume*this.masterVolume)}getMasterVolume(){return this.masterVolume}setMusicVolume(s){this.musicVolume=Math.max(0,Math.min(1,s)),this.currentMusic&&(this.currentMusic.volume=this.musicVolume*this.masterVolume)}initOnInteraction(){this.musicEnabled&&!this.currentMusic&&this.startMusic()}}const u=new F,q=A()(D((t,s)=>({user:null,profile:null,isAuthenticated:!1,setUser:e=>t({user:e,isAuthenticated:!!e}),setProfile:e=>t({profile:e}),logout:()=>t({user:null,profile:null,isAuthenticated:!1}),products:[],setProducts:e=>t({products:e}),getProductById:e=>s().products.find(i=>i.id===e),reviews:[],addReview:e=>t({reviews:[e,...s().reviews]}),getProductReviews:e=>s().reviews.filter(i=>i.productId===e),cart:[],addToCart:(e,i)=>{const n=e.tiers.find(o=>o.name===i)||e.tiers[0],{cart:r}=s(),c=r.findIndex(o=>o.productId===e.id&&o.tier===n.name);if(c>=0){const o=[...r];o[c].quantity+=1,t({cart:o})}else{const o={id:`${e.id}-${n.name}`,productId:e.id,title:e.title,tier:n.name,price:n.price,image:e.icon,quantity:1,selected:!0};t({cart:[...r,o]})}u.playAddToCart()},removeFromCart:e=>{const{cart:i}=s();u.playRemove(),t({cart:i.filter((n,r)=>r!==e)})},updateQuantity:(e,i)=>{const{cart:n}=s(),r=[...n];r[e].quantity+=i,r[e].quantity<1?(r.splice(e,1),u.playRemove()):u.playClick(),t({cart:r})},toggleItemSelection:e=>{const{cart:i}=s(),n=[...i];n[e].selected=!n[e].selected,u.playClick(),t({cart:n})},selectAllItems:e=>{const{cart:i}=s();u.playClick(),t({cart:i.map(n=>({...n,selected:e}))})},clearCart:()=>{u.playSuccess(),t({cart:[]})},getCartTotal:()=>{const{cart:e}=s(),i=e.filter(n=>n.selected);return{subtotal:i.reduce((n,r)=>n+r.price*r.quantity,0),count:i.reduce((n,r)=>n+r.quantity,0)}},getSelectedItems:()=>s().cart.filter(e=>e.selected),orders:[],setOrders:e=>t({orders:e}),addOrder:e=>{u.playSuccess(),t({orders:[e,...s().orders]})},currentSection:"home",setCurrentSection:e=>t({currentSection:e}),isLoading:!1,setIsLoading:e=>t({isLoading:e}),notification:null,setNotification:e=>t({notification:e}),recentlyViewed:[],addRecentlyViewed:e=>{const{recentlyViewed:i}=s(),n=i.filter(r=>r!==e);t({recentlyViewed:[e,...n].slice(0,10)})},isDarkMode:!1,toggleDarkMode:()=>t(e=>({isDarkMode:!e.isDarkMode})),soundEnabled:!0,toggleSound:()=>{const e=u.toggleSound();t({soundEnabled:e})},musicEnabled:!1,toggleMusic:()=>{const e=u.toggleMusic();t({musicEnabled:e})},hasSeenWelcome:!1,setHasSeenWelcome:e=>t({hasSeenWelcome:e}),hasSeenTutorial:!1,setHasSeenTutorial:e=>t({hasSeenTutorial:e})}),{name:"layanan-digital-storage",partialize:t=>({cart:t.cart,recentlyViewed:t.recentlyViewed,orders:t.orders,isDarkMode:t.isDarkMode,soundEnabled:t.soundEnabled,musicEnabled:t.musicEnabled,hasSeenWelcome:t.hasSeenWelcome,hasSeenTutorial:t.hasSeenTutorial})}));export{u as a,q as u};
